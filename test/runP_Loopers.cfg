process PROD  = 
{
    
    service = RandomNumberGeneratorService
    {
        PSet moduleSeeds =
        {
            untracked uint32 g4SimHits = 9876
        }
    }

    service = MessageLogger
    {
	untracked vstring destinations = {"cout"}
	untracked vstring categories = { "FwkJob" } 
	untracked PSet cout =
	{
	    untracked PSet default = { untracked int32 limit = 0 }
	    untracked PSet FwkJob  = { untracked int32 limit = -1 } # but FwkJob category - those unlimitted
	}
    }
    
    #The module which reads from a HepMC ASCII file
    #
    source = PoolSource {
	#	untracked vstring fileNames = {"file:single_muminus_pT0.6_eta0.1.root"}
	untracked vstring fileNames = {"file:single_piminus_pT0.2_eta0.1.root"}
	#	untracked uint32 firstEvent = 779
    }
    #    source = MCFileSource
    #    {
    #	# The HepMC test File
    #	untracked vstring fileNames = {"file:single_neutrino.random.dat"}
    #    }		
    untracked PSet maxEvents = {untracked int32 input = -1}
    
    #Geometry
    #
    include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
    
    #Magnetic Field
    #
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    
    # Output of events, etc...
    #
    # Explicit note : since some histos/tree might be dumped directly,
    #                 better NOT use PoolOutputModule !
    
    # Detector simulation (Geant4-based)
    #
    include "SimG4Core/Application/data/SimG4Object.cfi"
    replace g4SimHits.Generator.HepMCProductLabel = "source"
    replace g4SimHits.TrackerSD.EnergyThresholdForPersistencyInGeV = 0.01
    replace g4SimHits.TrackerSD.EnergyThresholdForHistoryInGeV = 0.001
    replace g4SimHits.SteppingAction.KillBeamPipe = false
    #    replace g4SimHits.UseMagneticField = false
    #    replace g4SimHits.Physics.type = "SimG4Core/Physics/DummyPhysics"
    #    replace g4SimHits.Physics.DummyEMPhysics = true
    #    replace g4SimHits.Physics.CutsPerRegion = false
    replace g4SimHits.Watchers = { 
	{ string type = "MaterialBudgetAction"
	    PSet MaterialBudgetAction = {
		string HistogramList = "Tracker"
		string HistosFile = "matbdg_Gigi.root"
		# string TextFile = "matbdg_Gigi.txt"
		string TextFile = "None"  # "None" means this option 
		string TreeFile = "loop_Gigi.root"  # is NOT requested
		bool AllStepsToTree = true
		# vstring SelectedVolumes = {"CMSE"}
		vstring SelectedVolumes = {"Tracker","BEAM"}
		# vstring SelectedVolumes = {"Tracker"}
		# vstring SelectedVolumes = {"PixelBarrel","PixelForwardZMinus","PixelForwardZPlus","TOB","TIB","TIDB","TIDF","TEC","TIBTIDServicesF","TIBTIDServicesB"}
		string StopAfterProcess = "None"
		# Decay
		untracked bool   storeDecay    = true
		untracked double EminDecayProd = 0 # MeV
	    }
	}
    }
    
    path p1 = { g4SimHits }
    
    #    module Out = PoolOutputModule { untracked string fileName = "single_muminus_SimHit.root" }    
    #    endpath p = { Out }
}
